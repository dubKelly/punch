#!/usr/bin/env python3

import json
import sys
import getpass
import datetime

# for arg in sys.argv:
#   if arg == 'in':
#     # open('punch_card.json', 'w')
#     date = datetime.datetime.now().date()
#     time = str(datetime.datetime.now().time())[:8]
def parse_args():
  for arg in sys.argv[1:]:
    if arg == 'in':
      punch_in()

def punch_in():
  user = getpass.getuser()
  date = str(datetime.datetime.now().date())
  time = str(datetime.datetime.now().time())[:8]

  # punch_card = {
  #   user: {
  #     date: {
  #       time: 'in'
  #     }
  #   }
  # }
  #
  # print(punch_card[user][date])
  with open('punchcard.json', 'r+') as punchcard:
    _file = json.load(punchcard)
    if _file[user]:
      if _file[user][date]:
        _file[user][date][time] = 'in'

    json.dump(_file, punchcard)

def main():
  parse_args()

main()
